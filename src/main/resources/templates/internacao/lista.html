<!DOCTYPE html>
<html xmlns:layout="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.w3.org/1999/xhtml" layout:decorate="~{layout}">
<head>
<meta charset="UTF-8" />
<style>
#alergias {
	width: 30%;
	height: 25px;
	background-color: white;
	transition: height 2s;
	transition: background-color 1s linear;
}
.ativa{
	color: green;
	
}
.encerrada{
	color: red
}
</style>
</head>
<body>

	<section class="layout-content" layout:fragment="corpo">
		<main role="main">
			<div class="album py-5 bg-light">
				<div class="container">

					<div class="row">
						<div class="col-md-12">

							<div th:replace="fragments/alert :: alerta-sucesso"></div>
							<h2>Internações Cadastradas</h2>

							<table id="table-internacoes"
								class="table table-sm table-striped table-bordered nowrap"
								style="width: 100%">
								<thead class="thead-dark">
									<tr>
										<th scope="col">Status</th>
										<th scope="col">Paciente</th>
										<th scope="col">Data de Entrada</th>
										<th scope="col">Data de Saída</th>
										<th scope="col">Editar</th>
										<th scope="col">Excluir</th>
										<th scope="col">Visualizar</th>
									</tr>
								</thead>
							</table>
						</div>
					</div>
				</div>
				<a class="btn-cadastrar-usuario" href="#" role="button"
					data-toggle="modal" data-target="#modal-internacao">Nova
					Internação</a> <span th:replace="internacao/modal :: modal-form"></span>
			</div>
		</main>

		<!-- 
			<div class="tabs tabs-style-flip">
				<nav>
					<ul>
						<li><a href="#section-flip-1" class="fas fa-file-medical-alt"><span>Internações
									Ativas</span></a></li>
						<li><a href="#section-flip-2" class="fas fa-notes-medical"
							style="color: purple"><span>Internações Encerradas</span></a></li>

					</ul>
				</nav>
				<div class="content-wrap">

					<section id="section-flip-1">
						<div th:each="i: ${internacaoAtiva}">
							<p>
								<span th:text="'Paciente: ' + ${i.animal.nome}"></span>
							</p>
							<p>
								<span th:text="'Status: ' + ${i.status}"></span>
							</p>
							<form class="form-inline" method="get"
								th:action="@{/internacoes/editar/{id} (id=${i.id})}">
								<button class="btn btn-outline-success my-2 my-sm-0">Editar</button>
							</form>
							<form class="form-inline" method="get"
								th:action="@{/internacoes/visualizar/{id} (id=${i.id})}">
								<button class="btn btn-outline-success my-2 my-sm-0">Visualizar</button>
							</form>
						</div>
					</section>
					<section id="section-flip-2">
						<div th:each="i: ${internacaoEncerrada}">
							<p>
								<span th:text="'Paciente: ' + ${i.animal.nome}"></span>
							</p>
							<p>
								<span th:text="'Status: ' + ${i.status}"></span>
							</p>
							<form class="form-inline" method="get"
								th:action="@{/internacoes/editar/{id} (id=${i.id})}">
								<button class="btn btn-outline-success my-2 my-sm-0">Editar</button>
							</form>
							<form class="form-inline" method="get"
								th:action="@{/internacoes/visualizar/{id} (id=${i.id})}">
								<button class="btn btn-outline-success my-2 my-sm-0">Visualizar</button>
							</form>
						</div>
					</section>
				</div>
			</div>
			-->

	</section>
	<script th:src="@{/js/internacao.js(v=${version})}" th:fragment="js"></script>
	<script th:inline="javascript" th:fragment="inlinescript">
	 var internacao = [[${internacao.id}]];
		$(document).ready(
				function() {
					document.getElementById('dataEntrada').max = new Date(
							new Date().getTime()
									- new Date().getTimezoneOffset() * 60000)
							.toISOString().split("T")[0];
				})
		$(document).ready(
				function() {
					document.getElementById('dataSaida').min = new Date(
							new Date().getTime()
									- new Date().getTimezoneOffset() * 60000)
							.toISOString().split("T")[0];
				})
		$("#animal").autocomplete({

			source : function(request, response) {
				$.ajax({
					method : "GET",
					url : "/pacientes/titulo",
					data : {
						termo : request.term
					},
					success : function(data) {
						response(data);
					}
				})
			}
		});
		$(document).ready(function(){
			if(internacao != null){
				$("#modal-internacao").modal('show');
				$(".modal-title").text("Editar Internação");
				$("#animal").attr('readonly', 'readonly');
			}
			if(internacao == null){
				$(".modal-title").text("Nova Internação");
			}
			if ($("#msg-erro").html() != "") {
				$("#modal-internacao").modal('show');
				if($("#animal").val() == ""){
					$("#animal").addClass('is-invalid');
					$("#erro-animal").show().text("Por favor informe a espécie");
				}
				$
				$("#msg-erro").css("color", "red");
				$(".is-invalid").css("border", "1px solid red");
			}

			$("#modal-internacao").on("hidden.bs.modal", function() {
				$(".is-invalid").removeClass("is-invalid").removeAttr('style');
				$("#msg-erro").hide();
				$("#modal-internacao").modal('hide');
				
			});
			
			$(".btn-cadastrar-usuario").on("click", function(){
				$(".form-control").val("");
				$("#animal").removeAttr('readonly');
				$("#erro-especie").hide();
				$(".modal-title").text("Nova Internação");
			});	
		});	
		
	</script>
</body>
</html>